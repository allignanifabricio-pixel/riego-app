<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recordatorio de Riego</title>

  <link rel="manifest" href="manifest.json">
</head>
<input id="name" placeholder="Nombre del Ã¡rbol" />
<input id="days" type="number" placeholder="Cada cuÃ¡ntos dÃ­as regar" />
<button onclick="addTree()">Agregar Ã¡rbol</button>


<h2>Mis Ã¡rboles</h2>
<div id="list"></div>


<h2>ðŸ“… Riegos de la semana</h2>
<div id="calendar" class="week"></div>


<script>
if ('serviceWorker' in navigator) {
navigator.serviceWorker.register('sw.js');
}


if ('Notification' in window) {
Notification.requestPermission();
}


const trees = JSON.parse(localStorage.getItem('trees') || '[]');


function addTree() {
const name = document.getElementById('name').value;
const days = parseInt(document.getElementById('days').value);
if (!name || !days) return;


trees.push({ name, days, last: Date.now() });
localStorage.setItem('trees', JSON.stringify(trees));
render();
}


function water(i) {
trees[i].last = Date.now();
localStorage.setItem('trees', JSON.stringify(trees));
render();
}


function render() {
const list = document.getElementById('list');
const calendar = document.getElementById('calendar');
list.innerHTML = '';
calendar.innerHTML = '';


const now = new Date();
const weekEnd = new Date(now.getTime() + 7 * 86400000);


trees.forEach((t, i) => {
const next = new Date(t.last + t.days * 86400000);


const div = document.createElement('div');
div.className = 'tree';
div.innerHTML = `<b>${t.name}</b><br>PrÃ³ximo riego: ${next.toLocaleDateString()}<br><button onclick="water(${i})">Regado hoy</button>`;
list.appendChild(div);


if (next >= now && next <= weekEnd) {
const d = document.createElement('div');
d.className = 'day';
d.innerText = `${next.toLocaleDateString()} (12:00) â†’ ${t.name}`;
calendar.appendChild(d);
}
});
}


render();
</script>
</body>

</html>
